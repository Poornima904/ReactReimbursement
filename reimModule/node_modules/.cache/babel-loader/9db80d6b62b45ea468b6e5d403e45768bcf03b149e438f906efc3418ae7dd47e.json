{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Container,Box,Toolbar,Button,Typography,TextField}from\"@material-ui/core\";import{DataGrid}from\"@mui/x-data-grid\";// Updated import for DataGrid\nimport{getTableData,getTableCount}from\"api\";// Ensure this path is correct\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const columns=[{field:\"reimbursmentId\",headerName:\"Reimbursement ID\",width:250},{field:\"reimbursementDate\",headerName:\"Reimbursement Date\",flex:1},{field:\"totalAmount\",headerName:\"Total Amount\",flex:1}];const PAGE_SIZE=15;export default function MasterPage(){const[items,setItems]=useState([]);const[loading,setLoading]=useState(false);const[rowCount,setRowCount]=useState(0);const[page,setPage]=useState(0);// Track the current page\nconst[pageSize,setPageSize]=useState(PAGE_SIZE);// Track the page size\n// Filter state\nconst[filterValues,setFilterValues]=useState({reimbursmentId:'',reimbursementDate:'',totalAmount:''});const loadData=async function(isFirstLoad){let skip=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;let filters=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};try{setLoading(true);if(isFirstLoad){const count=await getTableCount();setRowCount(count);}const _items=await getTableData({$top:pageSize,$skip:skip,...filters// Add filters to the request\n});const itemsWithIds=_items.map((item,index)=>({...item,id:index+skip// Ensure unique IDs across pages\n}));setItems(itemsWithIds);}catch(error){console.error(\"Error loading data:\",error);}finally{setLoading(false);}};const handlePageChange=newPage=>{setPage(newPage);loadData(false,newPage*pageSize,filterValues);};const handlePageSizeChange=newPageSize=>{setPageSize(newPageSize);loadData(false,page*newPageSize,filterValues);// Re-load data with the new page size\n};const handleCreate=()=>{console.log(\"Add button clicked\");};const handleRefresh=()=>{loadData(true,0,filterValues);// Reload the first page with current filters\n};const handleFilterChange=e=>{const{name,value}=e.target;setFilterValues(prev=>({...prev,[name]:value}));};const handleApplyFilter=()=>{setPage(0);// Reset to the first page on filter change\nloadData(true,0,filterValues);// Reload the first page with new filters\n};useEffect(()=>{loadData(true);},[page,pageSize]);return/*#__PURE__*/_jsxs(Container,{disableGutters:true,children:[/*#__PURE__*/_jsx(Box,{mb:2,children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(TextField,{label:\"Reimbursement ID\",variant:\"outlined\",name:\"reimbursmentId\",value:filterValues.reimbursmentId,onChange:handleFilterChange,style:{marginRight:'8px'}}),/*#__PURE__*/_jsx(TextField,{label:\"Reimbursement Date\",variant:\"outlined\",name:\"reimbursementDate\",type:\"date\",value:filterValues.reimbursementDate,onChange:handleFilterChange,InputLabelProps:{shrink:true},style:{marginRight:'8px'}}),/*#__PURE__*/_jsx(TextField,{label:\"Total Amount\",variant:\"outlined\",name:\"totalAmount\",value:filterValues.totalAmount,onChange:handleFilterChange,style:{marginRight:'8px'}}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleApplyFilter,children:\"Apply Filters\"})]})}),/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",style:{flex:1},children:\"Reimbursement Records\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleCreate,children:\"Create\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:handleRefresh,style:{marginLeft:'8px'},children:\"Refresh\"})]}),/*#__PURE__*/_jsx(Box,{height:\"80vh\",py:5,children:/*#__PURE__*/_jsx(DataGrid,{loading:loading,rows:items,columns:columns,pagination:true,paginationMode:\"server\",pageSize:pageSize,rowCount:rowCount,page:page,onPaginationModelChange:_ref=>{let{page,pageSize}=_ref;handlePageChange(page);handlePageSizeChange(pageSize);}})})]});}","map":{"version":3,"names":["React","useEffect","useState","Container","Box","Toolbar","Button","Typography","TextField","DataGrid","getTableData","getTableCount","jsx","_jsx","jsxs","_jsxs","columns","field","headerName","width","flex","PAGE_SIZE","MasterPage","items","setItems","loading","setLoading","rowCount","setRowCount","page","setPage","pageSize","setPageSize","filterValues","setFilterValues","reimbursmentId","reimbursementDate","totalAmount","loadData","isFirstLoad","skip","arguments","length","undefined","filters","count","_items","$top","$skip","itemsWithIds","map","item","index","id","error","console","handlePageChange","newPage","handlePageSizeChange","newPageSize","handleCreate","log","handleRefresh","handleFilterChange","e","name","value","target","prev","handleApplyFilter","disableGutters","children","mb","label","variant","onChange","style","marginRight","type","InputLabelProps","shrink","color","onClick","marginLeft","height","py","rows","pagination","paginationMode","onPaginationModelChange","_ref"],"sources":["/home/user/projects/ReactReimbursement/reimModule/src/pages/MasterPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Container, Box, Toolbar, Button, Typography, TextField } from \"@material-ui/core\";\nimport { DataGrid } from \"@mui/x-data-grid\"; // Updated import for DataGrid\nimport { getTableData, getTableCount } from \"api\"; // Ensure this path is correct\n\nconst columns = [\n  { field: \"reimbursmentId\", headerName: \"Reimbursement ID\", width: 250 },\n  { field: \"reimbursementDate\", headerName: \"Reimbursement Date\", flex: 1 },\n  { field: \"totalAmount\", headerName: \"Total Amount\", flex: 1 },\n];\n\nconst PAGE_SIZE = 15;\n\nexport default function MasterPage() {\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [rowCount, setRowCount] = useState(0);\n  const [page, setPage] = useState(0); // Track the current page\n  const [pageSize, setPageSize] = useState(PAGE_SIZE); // Track the page size\n\n  // Filter state\n  const [filterValues, setFilterValues] = useState({\n    reimbursmentId: '',\n    reimbursementDate: '',\n    totalAmount: ''\n  });\n\n  const loadData = async (isFirstLoad, skip = 0, filters = {}) => {\n    try {\n      setLoading(true);\n      if (isFirstLoad) {\n        const count = await getTableCount();\n        setRowCount(count);\n      }\n\n      const _items = await getTableData({\n        $top: pageSize,\n        $skip: skip,\n        ...filters // Add filters to the request\n      });\n\n      const itemsWithIds = _items.map((item, index) => ({\n        ...item,\n        id: index + skip // Ensure unique IDs across pages\n      }));\n\n      setItems(itemsWithIds);\n    } catch (error) {\n      console.error(\"Error loading data:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePageChange = (newPage) => {\n    setPage(newPage);\n    loadData(false, newPage * pageSize, filterValues);\n  };\n\n  const handlePageSizeChange = (newPageSize) => {\n    setPageSize(newPageSize);\n    loadData(false, page * newPageSize, filterValues); // Re-load data with the new page size\n  };\n\n  const handleCreate = () => {\n    console.log(\"Add button clicked\");\n  };\n\n  const handleRefresh = () => {\n    loadData(true, 0, filterValues); // Reload the first page with current filters\n  };\n\n  const handleFilterChange = (e) => {\n    const { name, value } = e.target;\n    setFilterValues((prev) => ({\n      ...prev,\n      [name]: value,\n    }));\n  };\n\n  const handleApplyFilter = () => {\n    setPage(0); // Reset to the first page on filter change\n    loadData(true, 0, filterValues); // Reload the first page with new filters\n  };\n\n  useEffect(() => {\n    loadData(true);\n  }, [page, pageSize]);\n\n  return (\n    <Container disableGutters>\n      <Box mb={2}>\n        <Toolbar>\n          {/* Filter Bar */}\n          <TextField\n            label=\"Reimbursement ID\"\n            variant=\"outlined\"\n            name=\"reimbursmentId\"\n            value={filterValues.reimbursmentId}\n            onChange={handleFilterChange}\n            style={{ marginRight: '8px' }}\n          />\n          <TextField\n            label=\"Reimbursement Date\"\n            variant=\"outlined\"\n            name=\"reimbursementDate\"\n            type=\"date\"\n            value={filterValues.reimbursementDate}\n            onChange={handleFilterChange}\n            InputLabelProps={{\n              shrink: true,\n            }}\n            style={{ marginRight: '8px' }}\n          />\n          <TextField\n            label=\"Total Amount\"\n            variant=\"outlined\"\n            name=\"totalAmount\"\n            value={filterValues.totalAmount}\n            onChange={handleFilterChange}\n            style={{ marginRight: '8px' }}\n          />\n          <Button variant=\"contained\" color=\"primary\" onClick={handleApplyFilter}>\n            Apply Filters\n          </Button>\n        </Toolbar>\n      </Box>\n      <Toolbar>\n        <Typography variant=\"h6\" style={{ flex: 1 }}>\n          Reimbursement Records\n        </Typography>\n        <Button variant=\"contained\" color=\"primary\" onClick={handleCreate}>\n          Create\n        </Button>\n        <Button variant=\"outlined\" color=\"secondary\" onClick={handleRefresh} style={{ marginLeft: '8px' }}>\n          Refresh\n        </Button>\n      </Toolbar>\n      <Box height=\"80vh\" py={5}>\n        <DataGrid\n          loading={loading}\n          rows={items}\n          columns={columns}\n          pagination\n          paginationMode=\"server\"\n          pageSize={pageSize}\n          rowCount={rowCount}\n          page={page}\n          onPaginationModelChange={({ page, pageSize }) => {\n            handlePageChange(page);\n            handlePageSizeChange(pageSize);\n          }}\n        />\n      </Box>\n    </Container>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}